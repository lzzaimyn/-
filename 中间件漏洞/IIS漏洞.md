IIS相关漏洞
IIS6.0 PUT漏洞
IIS6.0 解析漏洞
IIS7.0/7.5 解析漏洞
IIS短文件名漏洞
IIS6.0 远程代码执行漏洞 CVE-2017-7269

0x01 IIS6.0 PUT漏洞
漏洞原理：PUT方法是HTTP协议中的一种请求方法，用于向服务器上传资源。在IIS 6.0中，默认情况下，PUT方法被禁用，但如果WebDAV（Web分布式作者和版本控制）组件启用，则PUT方法会自动启用。攻击者可以利用PUT方法上传恶意代码，然后通过触发该代码来获取服务器的系统权限。
PUT方法滥用漏洞的原理如下：
1、攻击者向IIS服务器发送一个PUT请求，包含恶意代码的文件，并使用特定的URL路径。
2、IIS服务器收到PUT请求后，会将恶意代码的文件保存到磁盘上的指定位置。攻击者使用包含恶意代码的HTTP请求触发刚刚上传的文件，从而执行该文件中的代码。
3、由于PUT请求不需要身份验证，攻击者可以在未经授权的情况下上传和执行恶意代码。此外，由于IIS默认情况下不记录PUT请求，因此管理员可能难以检测到此类攻击。为了防止PUT漏洞的攻击
修复：禁用WebDAV组件，并定期检查服务器的组件和功能列表。
将服务器的IIS版本升级到最新版本，以获得更好的安全性和修复漏洞的保障。
对所有上传文件进行严格的验证和筛选，确保只允许上传合法的文件类型和大小。
配置适当的身份验证和访问控制，限制对服务器资源的访问权限。
监控服务器的日志和网络流量，及时检测和响应异常事件。
定期进行漏洞扫描和安全审计，以发现和修复潜在的安全漏洞。

0x02 IIS6.0 解析漏洞
文件解析
原理：IIS6.0默认不解析;号后面的内容，例如1.asp;.jpg会当成1.asp解析，相当于分号截断。
目录解析
原理：IIS6.0会将/xx.asp/ .txt或者其他类型文件当作asp文件去解析 例如/1.asp/ 1.jpg

0x03 IIS7.0/7.5 解析漏洞
原理：在FastCGI运行php的情况下，php默认配置cgi.fix_pathinfo=1，导致在任意文件后面添加/.php，服务器就会解析成php。 例如 1.jpg/ .php 就会把1.jpg解析为php文件
修复：将cgi.fix_pathinfo设置为0并重启php-cgi程序

0x04 短文件名漏洞
原理：为了兼容16位MS-DOS程序，Windows为文件名较长的文件（和文件夹）生成了对应的windows 8.3 短文件名。 在cmd使用命令dir /x查看，实际情况用python脚本跑。
结果：只有6位显示，后续字符用~1代替，后缀名称只显示3位。

0x05 IIS6.0 远程代码执行漏洞 CVE-2017-7269
原理：IIS6.0远程代码执行漏洞（CVE-2017-7269）是一种安全漏洞，攻击者可以利用该漏洞通过发送特定的HTTP请求，在目标系统上执行任意代码。该漏洞的原理是由于IIS6.0在处理WebDAV请求时ScStoragePathFromUrl函数存在缓冲区溢出漏洞，攻击者可以通过发送恶意请求来触发该漏洞，从而在目标系统上执行任意代码。
具体来说，攻击者可以通过以下方式利用IIS6.0远程代码执行漏洞进行攻击：
发送一个包含特定恶意字符串的HTTP请求，该字符串将导致IIS6.0处理WebDAV请求时发生缓冲区溢出。
缓冲区溢出会使攻击者能够覆盖并控制目标系统的代码执行路径。
攻击者可以利用这个漏洞来执行任意代码和操作，如下载和安装恶意软件、修改系统配置、窃取敏感信息等。
攻击者通过一个以"If: < http://" 开始的较长header头的PROPFIND请求执行任意代码，控制目标主机。
利用项目地址：https://github.com/admintony/Windows-Exploit/tree/master/IIS6_WebDAV_Scanner
修复：关闭WebDAV服务扩展

